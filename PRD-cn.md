# PRD-cn.md

## 一、总体设计

### 1.1 能力分工（核心原则）

1. **词典 / 候选词信息来源 = 稳定免费词典 API**

   * 包括：词性、基础英文释义、多语言释义（如有）、发音文本等
   * 目标：**解释内容由“词典”负责，不依赖大模型编造含义**

2. **大模型只负责“语言加工”**

   * 只做：

     * 造例句
     * 改写解释为更简单的英语
     * 把多语言释义整理成适合学习的形式
   * 不直接当“权威释义来源”

3. **多语言支持**

   * 支持多种 UI 语言（例如：中文、英文、日文、韩文）
   * 支持多种释义语言（用户可以选择「解释语言」）

---

## 二、词典 API 方案（候选词 + 释义）

### 2.1 功能目标

> 通过稳定的免费词典 API，为所有 5 字母候选词提供：
> 词性 + 基础释义 + 发音 +（可选）多语言释义。

### 2.2 词典 API 使用范围

1. **候选词列表中的释义预览**

   * 当用户点击「释义」时，**优先查询词典 API**
   * 获取：

     * 单词词性
     * 一个或多个英文释义
     * 发音（音标 / 音频 URL，如果有）
     * 其他语言释义（如果该词典支持）

2. **收藏夹中的释义展示**

   * 收藏夹内再次查看单词时，若已有缓存 → 用缓存
   * 无缓存 → 调用词典 API 获取

3. **多语言释义**

   * 若词典 API 本身支持多语言释义（如：英文→多语种）
   * 则直接展示对应语言释义
   * 若不支持，则 fallback 到「英文释义 + 翻译服务」

> 设计原则：**“释义内容的权威来源 = 词典 API，而不是大模型”**

---

## 三、大模型职责：造句 & 解释优化

### 3.1 模块定位

> 大模型只负责“生成型任务”，不负责“知识事实”。

包括：

1. 根据词典释义生成简单例句
2. 为非母语用户重写解释（简化英语）
3. 用用户选择的目标语言，生成友好的学习说明（在词典释义基础上加工）

---

### 3.2 具体功能

#### 功能 1：例句生成

流程：

1. 从词典 API 获取该单词的：

   * 英文释义
   * 词性 / 使用场景说明（如有）
2. 传给大模型，让它生成：

   * 1～2 个**短句**（B1 水平的简单英语）
   * 尽量使用常见词汇
3. 如果用户启用翻译 / 目标语言，则再调用翻译服务，把例句翻译为该语言。

在释义弹窗中的呈现：

> 例句（由 AI 生成，基于词典释义）
>
> * 英文句子
> * 对应目标语言翻译

---

#### 功能 2：简化解释（英文）

有些词典释义太学术、偏长，对非母语用户不友好。

流程：

1. 从词典 API 拿到原始英文释义（可能是多条）
2. 让大模型做一次「简化」：

   * 限制为 1～2 条
   * 使用简单单词和短句
   * 不新增新的意义，只做“改写”

效果：
用户看到的“主释义”是**简化版**，同时可折叠展示“原始词典释义”。

---

#### 功能 3：多语言学习说明

如果用户选择的**释义语言 ≠ 英文**，例如：日语 / 韩语：

* 流程：

  1. 先用词典 API 获取英文释义
  2. 用翻译服务 +（可选）大模型润色，使其更口语化 / 易懂

---

## 四、多语言支持设计

### 4.1 支持范围

分两层：

1. **UI 语言（界面）**

   * 支持：

     * 中文（简体）
     * 中文（繁体）
     * 英文
     * 后续可扩充：日文 / 韩文 / 法语 / 德语 / 西班牙文等

2. **释义语言（词典输出）**

   * 用户可以在设置中选择：

     * 只显示英文释义
     * 英文 + 中文
     * 英文 + 其他语言
   * 若词典 API 支持多语言 → 优先使用
   * 否则：英文释义 + 翻译服务生成的目标语言释义

---

### 4.2 设置项

在插件设置中新增：

1. **界面语言（UI Language）**

   * 下拉选择：`auto / 中文 / English / ...`
   * `auto` = 根据浏览器语言自动选择

2. **释义语言（Definition Language）**

   * 下拉多选或单选组合：

     * 仅英文
     * 英文 + 中文
     * 英文 + 日文
     * 自定义（未来）

3. **例句语言**

   * 英文例句 ✔（默认）
   * 是否显示例句翻译：勾选框
   * 例句翻译目标语言：跟随释义语言 或 单独设置

---

## 五、调用顺序与降级逻辑

以“用户点击候选词的释义”为例，完整流程：

1. 检查本地缓存：

   * 若该词已有词典结果 → 直接用缓存数据

2. 若无缓存 → 调用 **词典 API**：

   * 获取标准释义（英文 + 其他语言，如支持）
   * 如果调用失败：

     * 标记该词“词典暂不可用”
     * 提供简短提示：

       > 暂时无法获取词典数据，请稍后重试

3. 在成功拿到词典释义后：

   * 如果用户开启了「简化解释」：

     * 把英文释义丢给大模型 → 生成简化版本
   * 如果用户开启了「生成例句」：

     * 把单词 + 释义丢给大模型 → 生成 1～2 条例句
   * 如果用户开启了「翻译」：

     * 把释义 / 例句丢给翻译服务 → 得到目标语言版本

4. 把这一整套结果存入缓存，供下次快速展示。

> 关键点：**词典 API 是“事实源” → 大模型只是“加工器”。**
